"use strict";(self["webpackChunkeasyadmin"]=self["webpackChunkeasyadmin"]||[]).push([[136],{234:function(t,e,n){n.d(e,{Z:function(){return u}});var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"form-group",attrs:{role:"group"}},[t.label?e("label",{attrs:{for:t.id},domProps:{innerHTML:t._s(t.label)}}):t._e(),e("v-date-picker",{attrs:{attributes:t.attrs,value:t.selectedDate,"min-date":t.minDate,locale:"de","is-dark":"",popover:{placement:"bottom",visibility:"click"}},on:{input:function(e){return t.selectDate(e)}},scopedSlots:t._u([{key:"default",fn:function({inputValue:n,inputEvents:a,togglePopover:s}){return[e("div",{staticClass:"input-group"},[e("input",t._g({staticClass:"form-control form-control-sm",attrs:{type:"text",readonly:"",id:t.id},domProps:{value:n}},a)),e("div",{staticClass:"input-group-append"},[t.clearButton?e("button",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Datum löschen",placement:"top-end"},expression:"{\n                            content: 'Datum löschen',\n                            placement: 'top-end',\n                        }"}],staticClass:"btn btn-outline-secondary btn-sm text-danger",attrs:{type:"button"},on:{click:t.clearDate}},[e("i",{staticClass:"fa fa-ban"})]):t._e(),e("button",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Kalender öffnen",placement:"top-end"},expression:"{\n                            content: 'Kalender öffnen',\n                            placement: 'top-end',\n                        }"}],staticClass:"btn btn-outline-secondary btn-sm text-primary",attrs:{type:"button"},on:{click:s}},[e("i",{staticClass:"fa fa-calendar"})])])])]}}])}),t.description?e("small",{staticClass:"form-text text-muted w-100",domProps:{innerHTML:t._s(t.description)}}):t._e()],1)},s=[],i=n(5334),r=n(9490),o=i.w3.extend({name:"DatePicker",model:{prop:"selectedDate",event:"change"},props:["label","selectedDate","minDate","clearButton","description"],data(){return{id:null,attrs:[]}},mounted(){this.id=this._uid},filters:{date:function(t){return t?r.ou.fromISO(t).setLocale("de").toLocaleString(r.ou.DATE_MED_WITH_WEEKDAY):""}},methods:{selectDate(t){const e=r.ou.fromJSDate(t).toFormat("y-MM-dd");this.$emit("change",e)},clearDate(t){t.stopImmediatePropagation(),t.preventDefault(),this.$emit("change",null)}}}),l=o,c=n(1001),d=(0,c.Z)(l,a,s,!1,null,null,null),u=d.exports},7489:function(t,e,n){n.d(e,{Z:function(){return u}});var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("CCard",[e("CCardBody",{staticClass:"position-relative"},[e("div",{staticClass:"d-flex justify-content-between"},[e("div",{staticClass:"style-border"}),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex pl-3 pr-3",style:{flex:t.withEndDate?"0 0 140px":"0 0 70px"}},[e("div",{staticClass:"start-date"},[e("div",{staticClass:"event-day h3 mb-0"},[t._v(" "+t._s(t._f("day")(t.startDate))+" ")]),e("div",{staticClass:"event-month text-black-50"},[t._v(" "+t._s(t._f("month")(t.startDate))+" ")])]),t.endDate?e("div",{staticClass:"pl-3 pr-3 end-date"},[e("div",{staticClass:"event-day h3 mb-0"},[t._v(" "+t._s(t._f("day")(t.endDate))+" ")]),e("div",{staticClass:"event-month text-black-50"},[t._v(" "+t._s(t._f("month")(t.endDate))+" ")])]):t._e()]),e("div",{staticClass:"mr-3"},[e("div",{staticClass:"h5",domProps:{innerHTML:t._s(t.title)}}),e("div",{staticClass:"text-black-50",domProps:{innerHTML:t._s(t.content)}}),t.attachments&&t.attachments.length?e("ul",{staticClass:"list-unstyled"},t._l(t.attachments,(function(n){return e("li",{key:n.id,staticClass:"text-black-50 text-nowrap"},[e("CIcon",{staticClass:"mr-1",attrs:{name:"cil-file",size:"sm"}}),e("a",{staticClass:"text-black-50",attrs:{href:n.frontendPath,target:"_blank"}},[e("small",[t._v(t._s(n.title))])])],1)})),0):t._e()])]),e("div",{staticClass:"text-nowrap",staticStyle:{width:"80px"}},[e("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Bearbeiten",placement:"top-end"},expression:"{\n                        content: 'Bearbeiten',\n                        placement: 'top-end',\n                    }"}],staticClass:"btn",on:{click:function(e){return t.$emit("onEditItem")}}},[e("i",{staticClass:"fa fa-edit"})]),e("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Löschen",placement:"top-end"},expression:"{\n                        content: 'Löschen',\n                        placement: 'top-end',\n                    }"}],staticClass:"btn",attrs:{"aria-label":"Löschen"},on:{click:function(e){return t.$emit("onDeleteItem")}}},[e("i",{staticClass:"fa fa-trash"})])],1)])])],1)},s=[],i=n(538),r=n(9490),o=i["default"].extend({name:"ListEntryItem",props:["startDate","endDate","title","content","attachments","withEndDate"],filters:{day:function(t){return t?r.ou.fromISO(t).setLocale("de").toFormat("dd"):""},month:function(t){return t?r.ou.fromISO(t).setLocale("de").monthShort:""}}}),l=o,c=n(1001),d=(0,c.Z)(l,a,s,!1,null,"19c2ace6",null),u=d.exports},2516:function(t,e,n){n.r(e),n.d(e,{default:function(){return f}});var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("CRow",[e("CCol",{attrs:{md:"8"}},[e("CForm",{on:{submit:t.submitForm}},[e("CCard",[e("CCardHeader",[t._v(" Veranstalung bearbeiten ")]),e("CCardBody",[e("DatePicker",{attrs:{label:"Datum der Veranstaltung"},model:{value:t.eventEntry.date,callback:function(e){t.$set(t.eventEntry,"date",e)},expression:"eventEntry.date"}}),e("TextEditor",{attrs:{label:"Beschreibung",enableSourceMode:!!t.isAdmin,config:t.editorConfig},model:{value:t.eventEntry.text,callback:function(e){t.$set(t.eventEntry,"text",e)},expression:"eventEntry.text"}})],1),e("CCardFooter",{staticClass:"d-flex justify-content-end align-items-center"},[e("RouterLink",{staticClass:"mr-3 text-secondary",attrs:{to:{name:"events-overview"}}},[t._v(" Abbrechen ")]),e("CButton",{attrs:{type:"submit",color:"primary"}},[e("CIcon",{attrs:{name:"cil-check-circle"}}),t._v(" Speichern")],1)],1)],1)],1)],1),e("CCol",{attrs:{md:"4"}},[e("AttachmentsCard",{attrs:{modelFactory:t.modelFactory,attachmentRoute:t.attachmentRoute},model:{value:t.eventEntry.attachments,callback:function(e){t.$set(t.eventEntry,"attachments",e)},expression:"eventEntry.attachments"}})],1)],1)},s=[],i=n(5334),r=n(2124),o=n(234),l=n(3821),c=n(1447),d=n(9490),u=n(2379),m=i.w3.extend({name:"EventEntryForm",components:{AttachmentsCard:c.Z,DatePicker:o.Z,TextEditor:r.Z},data(){return{isSubmitting:!1,editorConfig:Object.assign({},u.Z.defaultEditorConfig,{toolbar:"undo | bold italic |                     bullist numlist | link | removeformat"})}},computed:{attachmentRoute(){return this.eventEntry.id?`${u.Z.host}/api/events/${this.eventEntry.id}/attach`:""},eventEntry(){return this.$store.state.events.selectedEvent||new l.Z},isAdmin(){return this.$store.state.auth.isAdmin()}},mounted(){const t=this.$route.params.eventId;t?this.loadEvent(t):this.$store.dispatch("events/select",new l.Z)},methods:{loadEvent(t){this.$store.dispatch("events/loadOne",t)},submitForm(t){if(t.preventDefault(),this.isSubmitting)return;this.isSubmitting=!0;const e=this.eventEntry.id?"update":"create";this.eventEntry.date=d.ou.fromISO(this.eventEntry.date).toFormat("y-MM-dd"),this.eventEntry.text=this.eventEntry.text.replace(/<\/?p>/g,""),this.$store.dispatch(`events/${e}`,this.eventEntry).then((()=>{this.$router.push({path:"/content/events/overview"})})).catch((()=>{this.$snotify.error("Die Veranstaltung konnte nicht gespeichert werden")})).finally((()=>{this.isSubmitting=!1}))},modelFactory(t){return l.Z.init(t)}}}),v=m,p=n(1001),h=(0,p.Z)(v,a,s,!1,null,null,null),f=h.exports},9777:function(t,e,n){n.r(e),n.d(e,{default:function(){return f}});var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("CRow",[e("CCol",{attrs:{md:"8"}},[e("PageHeader",{attrs:{title:"Veranstaltungen",icon:"cil-calendar",route:{name:"events-add"}}}),t.isLoading?e("LoadingIndicator"):t._e(),!t.isLoading&&t.events?e("div",[t.events.data.length?t._e():e("EmptyListInfo"),t._l(t.events.data,(function(n){return e("ListEntryItem",{key:n.id,attrs:{startDate:n.date,title:n.text,attachments:n.attachments},on:{onDeleteItem:function(e){return t.deleteEvent(n)},onEditItem:function(e){return t.$router.push({name:"events-edit",params:{eventId:n.id}})}}})})),t.events.total>t.events.per_page?e("CPagination",{staticClass:"sticky-bottom",attrs:{activePage:t.activePage,pages:t.events.last_page,align:"center"},on:{"update:activePage":[function(e){t.activePage=e},t.updateActivePage],"update:active-page":function(e){t.activePage=e}}}):t._e()],2):t._e()],1),e("CCol",{attrs:{md:"4"}},[e("FilterContainer",{attrs:{resultsCount:t.resultsCount,isActive:t.dateFilter},on:{reset:t.resetFilter}},[e("v-date-picker",{attrs:{"is-range":"","title-position":"left","is-expanded":"",locale:"de",attributes:t.calendarAttributes},on:{dayclick:t.loadEvents},model:{value:t.dateFilter,callback:function(e){t.dateFilter=e},expression:"dateFilter"}}),e("figcaption",{staticClass:"figure-caption mt-1"},[t._v(" Durch das Auswählen eines Start- und Enddatums kann die Liste links gefiltert werden. ")])],1)],1)],1)},s=[],i=n(538),r=n(3671),o=n(7489),l=n(6811),c=n(3137),d=n(8077),u=n(9490),m=i["default"].extend({name:"Events",components:{EmptyListInfo:d.Z,FilterContainer:r.Z,ListEntryItem:o.Z,LoadingIndicator:l.Z,PageHeader:c.Z},data(){return{isLoading:!0,dateFilter:null,activePage:1}},computed:{events(){return this.$store.state.events.all},calendarAttributes(){return this.events?[...this.events.data.map((t=>({dates:t.date,dot:{color:t.color,class:t.isComplete?"opacity-75":""},popover:{label:t.text}}))),{dates:new Date,highlight:{color:"green",fillMode:"outline"}}]:[]},filter(){const t={page:this.activePage};return this.dateFilter&&(t.startDate=u.ou.fromJSDate(this.dateFilter.start).toISODate(),t.endDate=u.ou.fromJSDate(this.dateFilter.end).toISODate()),t},resultsCount(){return this.events?this.events.total:0}},created(){this.loadEvents()},methods:{loadEvents(){this.isLoading=!0,this.$store.dispatch("events/loadAll",this.filter).catch((()=>{this.$snotify.error("Veranstaltungen konnten nicht geladen werden")})).finally((()=>{this.isLoading=!1}))},deleteEvent(t){window.confirm("Soll der Eintrag wirklich gelöscht werden?")&&this.$store.dispatch("events/delete",t).then((()=>{this.$snotify.success("Die Veranstaltung wurde gelöscht!"),this.loadEvents()})).catch((()=>{this.$snotify.error("Die Veranstaltung konnte nicht gelöscht werden!")}))},resetFilter(){this.dateFilter=null,this.loadEvents()},updateActivePage(t){this.activePage=t,this.loadEvents()}}}),v=m,p=n(1001),h=(0,p.Z)(v,a,s,!1,null,null,null),f=h.exports}}]);
//# sourceMappingURL=events.312df281.js.map