(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["events"],{"0cfd":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CCard",[n("CCardBody",{staticClass:"position-relative"},[n("div",{staticClass:"d-flex justify-content-between"},[n("div",{staticClass:"style-border"}),n("div",{staticClass:"d-flex"},[n("div",{staticClass:"d-flex pl-3 pr-3",style:{flex:t.withEndDate?"0 0 140px":"0 0 70px"}},[n("div",{staticClass:"start-date"},[n("div",{staticClass:"event-day h3 mb-0"},[t._v(" "+t._s(t._f("day")(t.startDate))+" ")]),n("div",{staticClass:"event-month text-black-50"},[t._v(" "+t._s(t._f("month")(t.startDate))+" ")])]),t.endDate?n("div",{staticClass:"pl-3 pr-3 end-date"},[n("div",{staticClass:"event-day h3 mb-0"},[t._v(" "+t._s(t._f("day")(t.endDate))+" ")]),n("div",{staticClass:"event-month text-black-50"},[t._v(" "+t._s(t._f("month")(t.endDate))+" ")])]):t._e()]),n("div",{staticClass:"mr-3"},[n("div",{staticClass:"h5",domProps:{innerHTML:t._s(t.title)}}),n("div",{staticClass:"text-black-50",domProps:{innerHTML:t._s(t.content)}}),t.attachments&&t.attachments.length?n("ul",{staticClass:"list-unstyled"},t._l(t.attachments,(function(e){return n("li",{key:e.id,staticClass:"text-black-50 text-nowrap"},[n("CIcon",{staticClass:"mr-1",attrs:{name:"cil-file",size:"sm"}}),n("a",{staticClass:"text-black-50",attrs:{href:e.frontendPath,target:"_blank"}},[n("small",[t._v(t._s(e.title))])])],1)})),0):t._e()])]),n("div",{staticClass:"text-nowrap",staticStyle:{width:"80px"}},[n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Bearbeiten",placement:"top-end"},expression:"{\n                        content: 'Bearbeiten',\n                        placement: 'top-end',\n                    }"}],staticClass:"btn",on:{click:function(e){return t.$emit("onEditItem")}}},[n("i",{staticClass:"fa fa-edit"})]),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Löschen",placement:"top-end"},expression:"{\n                        content: 'Löschen',\n                        placement: 'top-end',\n                    }"}],staticClass:"btn",attrs:{"aria-label":"Löschen"},on:{click:function(e){return t.$emit("onDeleteItem")}}},[n("i",{staticClass:"fa fa-trash"})])],1)])])],1)},i=[],s=n("a026"),r=n("1315"),o=s["default"].extend({name:"ListEntryItem",props:["startDate","endDate","title","content","attachments","withEndDate"],filters:{day:function(t){return t?r["DateTime"].fromISO(t).setLocale("de").toFormat("dd"):""},month:function(t){return t?r["DateTime"].fromISO(t).setLocale("de").monthShort:""}}}),c=o,l=(n("c290"),n("2877")),d=Object(l["a"])(c,a,i,!1,null,"19c2ace6",null);e["a"]=d.exports},c290:function(t,e,n){"use strict";var a=n("ddfc"),i=n.n(a);i.a},ddfc:function(t,e,n){},e640:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CRow",[n("CCol",{attrs:{md:"8"}},[n("PageHeader",{attrs:{title:"Veranstaltungen",icon:"cil-calendar",route:{name:"events-add"}}}),t.isLoading?n("LoadingIndicator"):t._e(),!t.isLoading&&t.events?n("div",[t.events.data.length?t._e():n("EmptyListInfo"),t._l(t.events.data,(function(e){return n("ListEntryItem",{key:e.id,attrs:{startDate:e.date,title:e.text,attachments:e.attachments},on:{onDeleteItem:function(n){return t.deleteEvent(e)},onEditItem:function(n){return t.$router.push({name:"events-edit",params:{eventId:e.id}})}}})})),t.events.total>t.events.per_page?n("CPagination",{staticClass:"sticky-bottom",attrs:{activePage:t.activePage,pages:t.events.last_page,align:"center"},on:{"update:activePage":[function(e){t.activePage=e},t.updateActivePage],"update:active-page":function(e){t.activePage=e}}}):t._e()],2):t._e()],1),n("CCol",{attrs:{md:"4"}},[n("FilterContainer",{attrs:{resultsCount:t.resultsCount,isActive:t.dateFilter},on:{reset:t.resetFilter}},[n("v-date-picker",{attrs:{"is-range":"","title-position":"left","is-expanded":"",locale:"de",attributes:t.calendarAttributes},on:{dayclick:t.loadEvents},model:{value:t.dateFilter,callback:function(e){t.dateFilter=e},expression:"dateFilter"}}),n("figcaption",{staticClass:"figure-caption mt-1"},[t._v(" Durch das Auswählen eines Start- und Enddatums kann die Liste links gefiltert werden. ")])],1)],1)],1)},i=[],s=(n("99af"),n("4de4"),n("d81d"),n("d3b7"),n("2909")),r=n("a026"),o=n("1237"),c=n("0cfd"),l=n("b758"),d=n("36ad"),u=n("1328"),m=n("1315"),v=r["default"].extend({name:"Events",components:{EmptyListInfo:u["a"],FilterContainer:o["a"],ListEntryItem:c["a"],LoadingIndicator:l["a"],PageHeader:d["a"]},data:function(){return{isLoading:!0,dateFilter:null,activePage:1}},computed:{events:function(){return this.$store.state.events.all},calendarAttributes:function(){return this.events?[].concat(Object(s["a"])(this.events.data.map((function(t){return{dates:t.date,dot:{color:t.color,class:t.isComplete?"opacity-75":""},popover:{label:t.text}}}))),[{dates:new Date,highlight:{color:"green",fillMode:"outline"}}]):[]},filter:function(){var t={page:this.activePage};return this.dateFilter&&(t.startDate=m["DateTime"].fromJSDate(this.dateFilter.start).toISODate(),t.endDate=m["DateTime"].fromJSDate(this.dateFilter.end).toISODate()),t},resultsCount:function(){return this.events?this.events.total:0}},created:function(){this.loadEvents()},methods:{loadEvents:function(){var t=this;this.isLoading=!0,this.$store.dispatch("events/loadAll",this.filter).catch((function(){t.$snotify.error("Veranstaltungen konnten nicht geladen werden")})).finally((function(){t.isLoading=!1}))},deleteEvent:function(t){var e=this;window.confirm("Soll der Eintrag wirklich gelöscht werden?")&&this.$store.dispatch("events/delete",t).then((function(){e.$snotify.success("Die Veranstaltung wurde gelöscht!"),e.loadEvents()})).catch((function(){e.$snotify.error("Die Veranstaltung konnte nicht gelöscht werden!")}))},resetFilter:function(){this.dateFilter=null,this.loadEvents()},updateActivePage:function(t){this.activePage=t,this.loadEvents()}}}),f=v,p=n("2877"),h=Object(p["a"])(f,a,i,!1,null,null,null);e["default"]=h.exports},e94a:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group",attrs:{role:"group"}},[t.label?n("label",{attrs:{for:t.id},domProps:{innerHTML:t._s(t.label)}}):t._e(),n("v-date-picker",{attrs:{attributes:t.attrs,value:t.selectedDate,"min-date":t.minDate,locale:"de","is-dark":"",popover:{placement:"bottom",visibility:"click"}},on:{input:function(e){return t.selectDate(e)}},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.inputValue,i=e.inputEvents,s=e.togglePopover;return[n("div",{staticClass:"input-group"},[n("input",t._g({staticClass:"form-control form-control-sm",attrs:{type:"text",readonly:"",id:t.id},domProps:{value:a}},i)),n("div",{staticClass:"input-group-append"},[t.clearButton?n("button",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Datum löschen",placement:"top-end"},expression:"{\n                            content: 'Datum löschen',\n                            placement: 'top-end',\n                        }"}],staticClass:"btn btn-outline-secondary btn-sm text-danger",attrs:{type:"button"},on:{click:t.clearDate}},[n("i",{staticClass:"fa fa-ban"})]):t._e(),n("button",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Kalender öffnen",placement:"top-end"},expression:"{\n                            content: 'Kalender öffnen',\n                            placement: 'top-end',\n                        }"}],staticClass:"btn btn-outline-secondary btn-sm text-primary",attrs:{type:"button"},on:{click:s}},[n("i",{staticClass:"fa fa-calendar"})])])])]}}])}),t.description?n("small",{staticClass:"form-text text-muted w-100",domProps:{innerHTML:t._s(t.description)}}):t._e()],1)},i=[],s=n("60a3"),r=n("1315"),o=s["a"].extend({name:"DatePicker",model:{prop:"selectedDate",event:"change"},props:["label","selectedDate","minDate","clearButton","description"],data:function(){return{id:null,attrs:[]}},mounted:function(){this.id=this._uid},filters:{date:function(t){return t?r["DateTime"].fromISO(t).setLocale("de").toLocaleString(r["DateTime"].DATE_MED_WITH_WEEKDAY):""}},methods:{selectDate:function(t){var e=r["DateTime"].fromJSDate(t).toFormat("y-MM-dd");this.$emit("change",e)},clearDate:function(t){t.stopImmediatePropagation(),t.preventDefault(),this.$emit("change",null)}}}),c=o,l=n("2877"),d=Object(l["a"])(c,a,i,!1,null,null,null);e["a"]=d.exports},f7fd:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CRow",[n("CCol",{attrs:{md:"8"}},[n("CForm",{on:{submit:t.submitForm}},[n("CCard",[n("CCardHeader",[t._v(" Veranstalung bearbeiten ")]),n("CCardBody",[n("DatePicker",{attrs:{label:"Datum der Veranstaltung"},model:{value:t.eventEntry.date,callback:function(e){t.$set(t.eventEntry,"date",e)},expression:"eventEntry.date"}}),n("TextEditor",{attrs:{label:"Beschreibung",enableSourceMode:!!t.isAdmin,config:t.editorConfig},model:{value:t.eventEntry.text,callback:function(e){t.$set(t.eventEntry,"text",e)},expression:"eventEntry.text"}})],1),n("CCardFooter",{staticClass:"d-flex justify-content-end align-items-center"},[n("RouterLink",{staticClass:"mr-3 text-secondary",attrs:{to:{name:"events-overview"}}},[t._v(" Abbrechen ")]),n("CButton",{attrs:{type:"submit",color:"primary"}},[n("CIcon",{attrs:{name:"cil-check-circle"}}),t._v(" Speichern")],1)],1)],1)],1)],1),n("CCol",{attrs:{md:"4"}},[n("AttachmentsCard",{attrs:{modelFactory:t.modelFactory,attachmentRoute:t.attachmentRoute},model:{value:t.eventEntry.attachments,callback:function(e){t.$set(t.eventEntry,"attachments",e)},expression:"eventEntry.attachments"}})],1)],1)},i=[],s=(n("99af"),n("d3b7"),n("ac1f"),n("5319"),n("60a3")),r=n("0f29"),o=n("e94a"),c=n("04b2"),l=n("103d"),d=n("1315"),u=n("d70b"),m=s["a"].extend({name:"EventEntryForm",components:{AttachmentsCard:l["a"],DatePicker:o["a"],TextEditor:r["a"]},data:function(){return{isSubmitting:!1,editorConfig:Object.assign({},u["a"].defaultEditorConfig,{toolbar:"undo | bold italic |                     bullist numlist | link | removeformat"})}},computed:{attachmentRoute:function(){return this.eventEntry.id?"".concat(u["a"].host,"/api/events/").concat(this.eventEntry.id,"/attach"):""},eventEntry:function(){return this.$store.state.events.selectedEvent||new c["a"]},isAdmin:function(){return this.$store.state.auth.isAdmin()}},mounted:function(){var t=this.$route.params.eventId;t?this.loadEvent(t):this.$store.dispatch("events/select",new c["a"])},methods:{loadEvent:function(t){this.$store.dispatch("events/loadOne",t)},submitForm:function(t){var e=this;if(t.preventDefault(),!this.isSubmitting){this.isSubmitting=!0;var n=this.eventEntry.id?"update":"create";this.eventEntry.date=d["DateTime"].fromISO(this.eventEntry.date).toFormat("y-MM-dd"),this.eventEntry.text=this.eventEntry.text.replace(/<\/?p>/g,""),this.$store.dispatch("events/".concat(n),this.eventEntry).then((function(){e.$router.push({path:"/content/events/overview"})})).catch((function(){e.$snotify.error("Die Veranstaltung konnte nicht gespeichert werden")})).finally((function(){e.isSubmitting=!1}))}},modelFactory:function(t){return c["a"].init(t)}}}),v=m,f=n("2877"),p=Object(f["a"])(v,a,i,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=events.94df320a.js.map