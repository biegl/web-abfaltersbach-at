(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages"],{"0e8a":function(t,e,n){"use strict";var i=n("a730"),s=n.n(i);s.a},"0f29":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("label",[t._v("Inhalt")]),t.enableSourceMode?n("div",{staticClass:"custom-control custom-switch",staticStyle:{float:"right"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.sourceEditor,expression:"sourceEditor"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"source-switch"},domProps:{checked:Array.isArray(t.sourceEditor)?t._i(t.sourceEditor,null)>-1:t.sourceEditor},on:{change:function(e){var n=t.sourceEditor,i=e.target,s=!!i.checked;if(Array.isArray(n)){var o=null,a=t._i(n,o);i.checked?a<0&&(t.sourceEditor=n.concat([o])):a>-1&&(t.sourceEditor=n.slice(0,a).concat(n.slice(a+1)))}else t.sourceEditor=s}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"source-switch"}},[t._v("Source Editor")])]):t._e(),t.enableSourceMode&&t.sourceEditor?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contentVal,expression:"contentVal"}],staticClass:"form-control",attrs:{rows:"20"},domProps:{value:t.contentVal},on:{input:function(e){e.target.composing||(t.contentVal=e.target.value)}}}):n("editor",{attrs:{"api-key":t.apiKey,init:t.editorConfig},model:{value:t.contentVal,callback:function(e){t.contentVal=e},expression:"contentVal"}})],1)},s=[],o=n("60a3"),a=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],r=function(t){return-1!==a.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},c=function(t,e,n){Object.keys(e).filter(r).forEach((function(i){var s=e[i];"function"===typeof s&&("onInit"===i?s(t,n):n.on(i.substring(2),(function(t){return s(t,n)})))}))},l=function(t,e){var n=t.$props.modelEvents?t.$props.modelEvents:null,i=Array.isArray(n)?n.join(" "):n;t.$watch("value",(function(n,i){e&&"string"===typeof n&&n!==i&&n!==e.getContent({format:t.$props.outputFormat})&&e.setContent(n)})),e.on(i||"change input undo redo",(function(){t.$emit("input",e.getContent({format:t.$props.outputFormat}))}))},u=function(t,e,n){var i=e.$props.value?e.$props.value:"",s=e.$props.initialValue?e.$props.initialValue:"";n.setContent(i||(e.initialized?e.cache:s)),e.$listeners.input&&l(e,n),c(t,e.$listeners,n),e.initialized=!0},d=0,p=function(t){var e=Date.now(),n=Math.floor(1e9*Math.random());return d++,t+"_"+n+d+String(e)},f=function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()},h=function(t){return"undefined"===typeof t||""===t?[]:Array.isArray(t)?t:t.split(" ")},m=function(t,e){return h(t).concat(h(e))},g=function(t){return null===t||void 0===t},b=function(){return{listeners:[],scriptId:p("tiny-script"),scriptLoaded:!1}},v=function(){var t=b(),e=function(t,e,n,i){var s=e.createElement("script");s.referrerPolicy="origin",s.type="application/javascript",s.id=t,s.src=n;var o=function(){s.removeEventListener("load",o),i()};s.addEventListener("load",o),e.head&&e.head.appendChild(s)},n=function(n,i,s){t.scriptLoaded?s():(t.listeners.push(s),n.getElementById(t.scriptId)||e(t.scriptId,n,i,(function(){t.listeners.forEach((function(t){return t()})),t.scriptLoaded=!0})))},i=function(){t=b()};return{load:n,reinitialize:i}},y=v(),S=n("c4a9"),C={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},$=function(){return $=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},$.apply(this,arguments)},E=function(t,e,n){return t(n||"div",{attrs:{id:e}})},w=function(t,e){return t("textarea",{attrs:{id:e},style:{visibility:"hidden"}})},_=function(t){return function(){var e=$($({},t.$props.init),{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:m(t.$props.init&&t.$props.init.plugins,t.$props.plugins),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(e){t.editor=e,e.on("init",(function(n){return u(n,t,e)})),t.$props.init&&"function"===typeof t.$props.init.setup&&t.$props.init.setup(e)}});f(t.element)&&(t.element.style.visibility="",t.element.style.display=""),Object(S["a"])().init(e)}},D={props:C,created:function(){this.elementId=this.$props.id||p("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(S["a"])())_(this)();else if(this.element&&this.element.ownerDocument){var t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=g(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js":this.$props.tinymceScriptSrc;y.load(this.element.ownerDocument,n,_(this))}},beforeDestroy:function(){null!==Object(S["a"])()&&Object(S["a"])().remove(this.editor)},deactivated:function(){var t;this.inlineEditor||(this.cache=this.editor.getContent(),null===(t=Object(S["a"])())||void 0===t||t.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&_(this)()},render:function(t){return this.inlineEditor?E(t,this.elementId,this.$props.tagName):w(t,this.elementId)}},F=D,P=n("d70b"),k=o["a"].extend({name:"TextEditor",props:["value","config","enableSourceMode"],components:{editor:F},data:function(){return{sourceEditor:!1,editorConfig:this.config||P["a"].defaultEditorConfig}},computed:{apiKey:function(){return P["a"].editorApiKey},contentVal:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}}),x=k,A=(n("1b91"),n("2877")),M=Object(A["a"])(x,i,s,!1,null,null,null);e["a"]=M.exports},"0ff4":function(t,e,n){"use strict";var i=n("4c6d"),s=n.n(i);s.a},"1b91":function(t,e,n){"use strict";var i=n("6a3a"),s=n.n(i);s.a},"4c6d":function(t,e,n){},"6a3a":function(t,e,n){},a730:function(t,e,n){},a955:function(t,e,n){"use strict";var i=n("f432"),s=n.n(i);s.a},c4a9:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return s}));var i=function(){return"undefined"!==typeof window?window:t},s=function(){var t=i();return t&&t.tinymce?t.tinymce:null}}).call(this,n("c8ba"))},ee3e:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pages-container"},[n("div",{staticClass:"workspace"},[n("div",{staticClass:"main-content"},[n("div",{staticClass:"container"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"mt-3"},[n("button",{staticClass:"btn btn-primary float-right",attrs:{disabled:t.selectedPage},on:{click:t.createPage}},[t._v(" Erstellen ")]),n("h1",[t._v("Seiten")])]),n("table",{staticClass:"table table-bordered table-sm"},[t._m(0),t.isLoading?n("tbody",[n("tr",[n("td",{attrs:{colspan:"3"}},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"spinner-border spinner-border-sm"}),t._v(" Seiten werden geladen ")])])]):0==t.pages.length?n("tbody",[t._m(1)]):n("tbody",t._l(t.pages,(function(e){return n("tr",{key:e.id},[n("td",[n("div",[t._v(t._s(e.seitentitel))])]),n("td",[e.attachments&&0!=e.attachments.length?n("ul",{staticClass:"pages-file-list"},t._l(e.attachments,(function(e){return n("li",{key:e.ID},[n("a",{attrs:{href:e.frontendPath}},[t._v(t._s(e.title))]),n("small",[t._v(t._s(e.readableFileSize))])])})),0):n("span",[t._v("-")])]),n("td",[n("div",{staticClass:"row-actions"},[n("button",{staticClass:"btn btn-default",attrs:{type:"button","aria-label":"Bearbeiten",title:"Bearbeiten"},on:{click:function(n){return t.editPage(e)}}},[n("i",{staticClass:"fa fa-edit"})]),n("button",{staticClass:"btn btn-danger",attrs:{type:"button","aria-label":"Löschen",title:"Löschen"},on:{click:function(n){return t.deletePage(e)}}},[n("i",{staticClass:"fa fa-trash"})])])])])})),0)])])])]),n("page-entry-form",{directives:[{name:"show",rawName:"v-show",value:t.selectedPage,expression:"selectedPage"}],attrs:{adminMode:t.isAdmin},on:{cancelForm:t.cancelPageForm,onSubmissionStart:function(e){t.isSubmitting=!0},onSubmissionEnd:function(e){t.isSubmitting=!1},onSubmissionSuccess:t.onFormSubmissionSuccess,onSubmissionError:t.onFormSubmissionError}})],1)])])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",{staticClass:"date",attrs:{scope:"col"}},[t._v("Titel")]),n("th",{staticClass:"date",attrs:{scope:"col"}},[t._v(" Dateien ")]),n("th",{attrs:{scope:"col",width:"108"}})])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("td",{attrs:{colspan:"3"}},[t._v(" Keine Seiten vorhanden. ")])])}],o=(n("d3b7"),n("2b0e")),a=n("0255"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.pageEntry?n("div",{staticClass:"form-container"},[n("div",{staticClass:"form-background"}),n("div",{staticClass:"event-create"},[n("form",{staticClass:"container form",on:{submit:t.submitForm}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-3"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"exampleInputEmail1"}},[t._v("Titel")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.pageEntry.seitentitel,expression:"pageEntry.seitentitel"}],staticClass:"form-control form-control-sm",attrs:{type:"text","aria-describedby":"titelHelp",required:"",autofocus:""},domProps:{value:t.pageEntry.seitentitel},on:{input:function(e){e.target.composing||t.$set(t.pageEntry,"seitentitel",e.target.value)}}}),n("small",{staticClass:"form-text text-muted",attrs:{id:"titelHelp"}},[t._v(" Die Überschrift der Seite ")])])]),n("div",{staticClass:"col-md-6"},[n("text-editor",{attrs:{enableSourceMode:t.adminMode&&!!t.adminMode},model:{value:t.pageEntry.inhalt,callback:function(e){t.$set(t.pageEntry,"inhalt",e)},expression:"pageEntry.inhalt"}})],1),n("div",{staticClass:"col-md-3"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"file"}},[t._v("Dateien")]),t.pageEntry.attachments&&t.pageEntry.attachments.length>0?n("ul",{staticClass:"file-list"},t._l(t.pageEntry.attachments,(function(e){return n("li",{key:e.ID},[n("attachment",{attrs:{file:e,editMode:t.isFileBeingEdited(e)},on:{onEditFile:t.onEditFile,onAttachmentsUpdated:t.onAttachmentsUpdated}})],1)})),0):t._e(),t.pageEntry.id?n("file-input",{attrs:{route:t.attachmentRoute},on:{onUploadSuccessful:t.onUploadSuccessful,onUploadFailed:t.onUploadFailed}}):n("div",[n("small",[t._v("Dateien können erst hochgeladen werden, nachdem die Seite gespeichert wurde.")])])],1)])]),n("div",{staticClass:"row"},[n("div",{staticClass:"col text-right"},[n("button",{staticClass:"btn",attrs:{type:"button",disabled:t.isSubmitting},on:{click:t.cancelForm}},[t._v(" Abbrechen ")]),n("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.isSubmitting}},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.isSubmitting,expression:"isSubmitting"}],staticClass:"spinner-border spinner-border-sm"}),n("span",{directives:[{name:"show",rawName:"v-show",value:!t.isSubmitting,expression:"!isSubmitting"}]},[t._v(" Speichern ")])])])])])])]):t._e()},c=[],l=(n("99af"),n("60a3")),u=n("d70b"),d=n("b1b6"),p=n("f509"),f=n("0f29"),h=l["a"].extend({name:"PageEntryForm",props:["adminMode"],components:{TextEditor:f["a"],FileInput:d["a"],Attachment:p["a"]},data:function(){return{isSubmitting:!1,editedFile:null}},computed:{attachmentRoute:function(){return this.pageEntry.id?"".concat(u["a"].host,"/api/pages/").concat(this.pageEntry.id,"/attach"):""},pageEntry:function(){return this.$store.state.pages.selectedPage}},methods:{submitForm:function(t){var e=this;if(t.preventDefault(),!this.isSubmitting){this.isSubmitting=!0,this.$emit("onSubmissionStart",!0);var n=this.pageEntry.id?"update":"create";this.$store.dispatch("pages/".concat(n),this.pageEntry).then((function(){e.isCreating=!1,e.$emit("onSubmissionSuccess")})).catch((function(t){e.$emit("onSubmissionError",t)})).finally((function(){e.isSubmitting=!1,e.$emit("onSubmissionEnd",!1)}))}},cancelForm:function(){this.$emit("cancelForm")},onUploadSuccessful:function(t){this.$store.dispatch("pages/updatePage",a["a"].init(t[0])),this.$snotify.success("Upload erfolgreich")},onUploadFailed:function(){this.$snotify.error("Beim Upload ist ein Fehler aufgetreten!")},onEditFile:function(t){this.editedFile=t},isFileBeingEdited:function(t){return this.editedFile&&this.editedFile.id==t.id},onAttachmentsUpdated:function(){this.$store.dispatch("pages/load")}}}),m=h,g=(n("0ff4"),n("2877")),b=Object(g["a"])(m,r,c,!1,null,"05401f78",null),v=b.exports,y=o["default"].extend({components:{PageEntryForm:v},name:"Pages",data:function(){return{isLoading:!1,isSubmitting:!1}},computed:{pages:function(){return this.$store.state.pages.all},selectedPage:function(){return this.$store.state.pages.selectedPage},isAdmin:function(){return this.$store.state.auth.isAdmin()}},created:function(){this.loadPages()},methods:{loadPages:function(){var t=this;this.isLoading=!0,this.$store.dispatch("pages/load").catch((function(){t.$snotify.error("Die Seiten konnten nicht geladen werden")})).finally((function(){t.isLoading=!1}))},createPage:function(){this.$store.dispatch("pages/select",new a["a"])},editPage:function(t){this.$store.dispatch("pages/select",t)},cancelPageForm:function(){this.$store.dispatch("pages/select",null)},deletePage:function(t){var e=this;window.confirm("Soll die Seite wirklich gelöscht werden?")&&this.$store.dispatch("pages/delete",t).then((function(){e.$snotify.success("Die Seite wurde gelöscht!")})).catch((function(){e.$snotify.error("Die Seite konnte nicht gelöscht werden!")}))},onFormSubmissionSuccess:function(){this.$snotify.success("Die Seite wurde gespeichert!"),this.$store.dispatch("pages/select",null)},onFormSubmissionError:function(){this.$snotify.error("Die Seite konnte nicht gespeichert werden!")}}}),S=y,C=(n("0e8a"),Object(g["a"])(S,i,s,!1,null,"6045412c",null));e["default"]=C.exports},f432:function(t,e,n){},f509:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.editMode?n("input",{directives:[{name:"model",rawName:"v-model",value:t.file.title,expression:"file.title"}],domProps:{value:t.file.title},on:{input:function(e){e.target.composing||t.$set(t.file,"title",e.target.value)}}}):n("span",[t._v(t._s(t.file.title))]),t.editMode?t._e():n("button",{staticClass:"btn btn-sm",attrs:{type:"button",title:"Bearbeiten"},on:{click:this.edit}},[n("i",{staticClass:"fa fa-edit"})]),t.editMode?n("button",{staticClass:"btn btn-sm",attrs:{type:"button",title:"Speichern",disabled:!this.isDirty},on:{click:this.save}},[n("i",{staticClass:"fa fa-check"})]):t._e(),t.editMode?n("button",{staticClass:"btn btn-sm",attrs:{type:"button",title:"Abbrechen"},on:{click:this.cancel}},[n("i",{staticClass:"fa fa-times"})]):t._e(),t.editMode?t._e():n("button",{staticClass:"btn btn-sm",attrs:{type:"button",title:"Löschen"},on:{click:this.delete}},[n("i",{staticClass:"fa fa-trash"})])])},s=[],o=(n("d3b7"),n("60a3")),a=o["a"].extend({name:"Attachment",props:["file","editMode"],data:function(){return{title:""}},computed:{isDirty:function(){return""!=this.file.title&&this.file.title!=this.title}},methods:{edit:function(){this.title=this.file.title,this.$emit("onEditFile",this.file)},cancel:function(){this.file.title=this.title,this.$emit("onEditFile",null)},save:function(){var t=this;this.$store.dispatch("files/partialUpdate",this.file).then((function(){t.$emit("onAttachmentsUpdated",t.file),t.$snotify.success("Der Dateiname wurde geändert.")})).catch((function(){t.$snotify.error("Die Datei konnte nicht umbenannt werden!")})).finally((function(){t.$emit("onEditFile",null)}))},delete:function(){var t=this;window.confirm('Soll die Datei "'.concat(this.file.title,'" wirklich gelöscht werden?'))&&this.$store.dispatch("files/delete",this.file).then((function(){t.$emit("onAttachmentsUpdated",t.file),t.$snotify.success("Die Datei wurde gelöscht.")})).catch((function(){t.$snotify.error("Die Datei konnte nicht gelöscht werden!")}))}}}),r=a,c=(n("a955"),n("2877")),l=Object(c["a"])(r,i,s,!1,null,"705b0e79",null);e["a"]=l.exports}}]);
//# sourceMappingURL=pages.5ef0068a.js.map