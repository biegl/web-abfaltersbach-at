(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["news"],{"0cfd":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CCard",[n("CCardBody",{staticClass:"position-relative"},[n("div",{staticClass:"d-flex justify-content-between"},[n("div",{staticClass:"style-border"}),n("div",{staticClass:"d-flex"},[n("div",{staticClass:"d-flex pl-3 pr-3",style:{flex:t.withEndDate?"0 0 140px":"0 0 70px"}},[n("div",{staticClass:"start-date"},[n("div",{staticClass:"event-day h3 mb-0"},[t._v(" "+t._s(t._f("day")(t.startDate))+" ")]),n("div",{staticClass:"event-month text-black-50"},[t._v(" "+t._s(t._f("month")(t.startDate))+" ")])]),t.endDate?n("div",{staticClass:"pl-3 pr-3 end-date"},[n("div",{staticClass:"event-day h3 mb-0"},[t._v(" "+t._s(t._f("day")(t.endDate))+" ")]),n("div",{staticClass:"event-month text-black-50"},[t._v(" "+t._s(t._f("month")(t.endDate))+" ")])]):t._e()]),n("div",{staticClass:"mr-3"},[n("div",{staticClass:"h5",domProps:{innerHTML:t._s(t.title)}}),n("div",{staticClass:"text-black-50",domProps:{innerHTML:t._s(t.content)}}),t.attachments&&t.attachments.length?n("ul",{staticClass:"list-unstyled"},t._l(t.attachments,(function(e){return n("li",{key:e.id,staticClass:"text-black-50 text-nowrap"},[n("CIcon",{staticClass:"mr-1",attrs:{name:"cil-file",size:"sm"}}),n("a",{staticClass:"text-black-50",attrs:{href:e.frontendPath,target:"_blank"}},[n("small",[t._v(t._s(e.title))])])],1)})),0):t._e()])]),n("div",{staticClass:"text-nowrap",staticStyle:{width:"80px"}},[n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Bearbeiten",placement:"top-end"},expression:"{\n                        content: 'Bearbeiten',\n                        placement: 'top-end',\n                    }"}],staticClass:"btn",on:{click:function(e){return t.$emit("onEditItem")}}},[n("i",{staticClass:"fa fa-edit"})]),n("CLink",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Löschen",placement:"top-end"},expression:"{\n                        content: 'Löschen',\n                        placement: 'top-end',\n                    }"}],staticClass:"btn",attrs:{"aria-label":"Löschen"},on:{click:function(e){return t.$emit("onDeleteItem")}}},[n("i",{staticClass:"fa fa-trash"})])],1)])])],1)},s=[],i=n("a026"),r=n("1315"),o=i["default"].extend({name:"ListEntryItem",props:["startDate","endDate","title","content","attachments","withEndDate"],filters:{day:function(t){return t?r["DateTime"].fromISO(t).setLocale("de").toFormat("dd"):""},month:function(t){return t?r["DateTime"].fromISO(t).setLocale("de").monthShort:""}}}),c=o,l=(n("c290"),n("2877")),d=Object(l["a"])(c,a,s,!1,null,"19c2ace6",null);e["a"]=d.exports},"4b86":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CRow",[n("CCol",{attrs:{md:"8"}},[n("PageHeader",{attrs:{title:"News",icon:"cil-newspaper",route:{name:"news-add"}}}),t.isLoading?n("LoadingIndicator"):t._e(),!t.isLoading&&t.allNews?n("div",[t.allNews.data.length?t._e():n("EmptyListInfo"),t._l(t.allNews.data,(function(e){return n("ListEntryItem",{key:e.id,attrs:{startDate:e.date,endDate:e.expirationDate,withEndDate:!0,title:e.title,content:e.text,attachments:e.attachments},on:{onDeleteItem:function(n){return t.deleteNews(e)},onEditItem:function(n){return t.$router.push({name:"news-edit",params:{newsId:e.id}})}}})})),t.allNews.total>t.allNews.per_page?n("CPagination",{staticClass:"sticky-bottom",attrs:{activePage:t.activePage,pages:t.allNews.last_page,align:"center"},on:{"update:activePage":[function(e){t.activePage=e},t.updateActivePage],"update:active-page":function(e){t.activePage=e}}}):t._e()],2):t._e()],1),n("CCol",{attrs:{md:"4"}},[n("FilterContainer",{attrs:{resultsCount:t.resultsCount,isActive:"all"==t.selectedFilter},on:{reset:function(e){return t.updateFilter("active")}}},[n("CInputRadioGroup",{staticClass:"col-sm-9",attrs:{options:t.filterOptions,checked:t.selectedFilter},on:{"update:checked":t.updateFilter}})],1)],1)],1)},s=[],i=(n("d3b7"),n("a026")),r=n("0cfd"),o=n("36ad"),c=n("b758"),l=n("1237"),d=n("1328"),u=i["default"].extend({name:"News",components:{EmptyListInfo:d["a"],FilterContainer:l["a"],ListEntryItem:r["a"],LoadingIndicator:c["a"],PageHeader:o["a"]},data:function(){return{isLoading:!0,activePage:1,filterOptions:[{value:"active",label:"Aktive anzeigen"},{value:"all",label:"Alle anzeigen"}],selectedFilter:"active"}},computed:{allNews:function(){return this.$store.state.news.all},filteredNews:function(){var t="active"==this.selectedFilter?this.activeNews:this.allNews;return t},resultsCount:function(){return this.allNews?this.allNews.total:0}},created:function(){this.loadNews()},methods:{loadNews:function(){var t=this;this.isLoading=!0,this.$store.dispatch("news/loadAll",{page:this.activePage,showAll:this.selectedFilter}).catch((function(){t.$snotify.error("News konnten nicht geladen werden")})).finally((function(){t.isLoading=!1}))},deleteNews:function(t){var e=this;window.confirm("Soll der Eintrag wirklich gelöscht werden?")&&this.$store.dispatch("news/delete",t).then((function(){e.$snotify.success("News wurde gelöscht!"),e.loadNews()})).catch((function(){e.$snotify.error("News konnte nicht gelöscht werden!")}))},updateFilter:function(t){this.selectedFilter=t,this.loadNews()},updateActivePage:function(t){this.activePage=t,this.loadNews()}}}),m=u,p=n("2877"),f=Object(p["a"])(m,a,s,!1,null,null,null);e["default"]=f.exports},c28d:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("CRow",[n("CCol",{attrs:{md:"8"}},[n("CForm",{on:{submit:t.submitForm}},[n("CCard",[n("CCardHeader",[t._v(" News bearbeiten ")]),n("CCardBody",[n("CInput",{attrs:{description:"Die Überschrift für den Newseintrag",label:"Titel"},model:{value:t.newsEntry.title,callback:function(e){t.$set(t.newsEntry,"title",e)},expression:"newsEntry.title"}}),n("TextEditor",{attrs:{enableSourceMode:!!t.isAdmin},model:{value:t.newsEntry.text,callback:function(e){t.$set(t.newsEntry,"text",e)},expression:"newsEntry.text"}})],1),n("CCardFooter",{staticClass:"d-flex justify-content-end align-items-center"},[n("RouterLink",{staticClass:"mr-3 text-secondary",attrs:{to:{name:"news-overview"}}},[t._v(" Abbrechen ")]),n("CButton",{attrs:{type:"submit",color:"primary"}},[n("CIcon",{attrs:{name:"cil-check-circle"}}),t._v(" Speichern")],1)],1)],1)],1)],1),n("CCol",{attrs:{md:"4"}},[n("CCard",[n("CCardHeader",[n("CIcon",{staticClass:"text-secondary",attrs:{name:"cil-settings"}}),t._v(" Einstellungen ")],1),n("CCardBody",[n("CForm",[n("DatePicker",{attrs:{label:"Start Datum",description:"Der Eintrag wird ab diesem Datum angezeigt"},on:{change:t.checkExpirationDate},model:{value:t.newsEntry.date,callback:function(e){t.$set(t.newsEntry,"date",e)},expression:"newsEntry.date"}}),n("DatePicker",{attrs:{label:"Anzeige bis",minDate:t.newsEntry.date,clearButton:"true",description:"Der Eintrag wird bis zu diesem Datum angezeigt."},model:{value:t.newsEntry.expirationDate,callback:function(e){t.$set(t.newsEntry,"expirationDate",e)},expression:"newsEntry.expirationDate"}})],1)],1)],1),n("AttachmentsCard",{attrs:{modelFactory:t.modelFactory,attachmentRoute:t.attachmentRoute},model:{value:t.newsEntry.attachments,callback:function(e){t.$set(t.newsEntry,"attachments",e)},expression:"newsEntry.attachments"}})],1)],1)},s=[],i=(n("99af"),n("d3b7"),n("60a3")),r=n("e94a"),o=n("0f29"),c=n("103d"),l=n("0758"),d=n("1315"),u=n("d70b"),m=i["a"].extend({name:"NewsEntryForm",components:{AttachmentsCard:c["a"],DatePicker:r["a"],TextEditor:o["a"]},data:function(){return{isSubmitting:!1}},computed:{attachmentRoute:function(){return this.newsEntry.id?"".concat(u["a"].host,"/api/news/").concat(this.newsEntry.id,"/attach"):""},newsEntry:function(){return this.$store.state.news.selectedNews||new l["a"]},isAdmin:function(){return this.$store.state.auth.isAdmin()}},mounted:function(){var t=this.$route.params.newsId;t?this.loadNews(t):this.$store.dispatch("news/select",new l["a"])},methods:{loadNews:function(t){this.$store.dispatch("news/loadOne",t)},submitForm:function(t){var e=this;if(t.preventDefault(),!this.isSubmitting){this.isSubmitting=!0;var n=this.newsEntry.id?"update":"create";this.$store.dispatch("news/".concat(n),this.newsEntry).then((function(){e.$router.push({path:"/content/news/overview"})})).catch((function(){e.$snotify.error("News konnte nicht gespeichert werden")})).finally((function(){e.isSubmitting=!1}))}},checkExpirationDate:function(){var t=this.newsEntry,e=t.date,n=t.expirationDate;if(n&&e){var a=d["DateTime"].fromISO(e),s=d["DateTime"].fromISO(n);a>s&&(this.newsEntry.expirationDate=e)}},modelFactory:function(t){return l["a"].init(t)}}}),p=m,f=n("2877"),h=Object(f["a"])(p,a,s,!1,null,null,null);e["default"]=h.exports},c290:function(t,e,n){"use strict";var a=n("ddfc"),s=n.n(a);s.a},ddfc:function(t,e,n){},e94a:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group",attrs:{role:"group"}},[t.label?n("label",{attrs:{for:t.id},domProps:{innerHTML:t._s(t.label)}}):t._e(),n("v-date-picker",{attrs:{attributes:t.attrs,value:t.selectedDate,"min-date":t.minDate,locale:"de","is-dark":"",popover:{placement:"bottom",visibility:"click"}},on:{input:function(e){return t.selectDate(e)}},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.inputValue,s=e.inputEvents,i=e.togglePopover;return[n("div",{staticClass:"input-group"},[n("input",t._g({staticClass:"form-control form-control-sm",attrs:{type:"text",readonly:"",id:t.id},domProps:{value:a}},s)),n("div",{staticClass:"input-group-append"},[t.clearButton?n("button",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Datum löschen",placement:"top-end"},expression:"{\n                            content: 'Datum löschen',\n                            placement: 'top-end',\n                        }"}],staticClass:"btn btn-outline-secondary btn-sm text-danger",attrs:{type:"button"},on:{click:t.clearDate}},[n("i",{staticClass:"fa fa-ban"})]):t._e(),n("button",{directives:[{name:"c-tooltip",rawName:"v-c-tooltip",value:{content:"Kalender öffnen",placement:"top-end"},expression:"{\n                            content: 'Kalender öffnen',\n                            placement: 'top-end',\n                        }"}],staticClass:"btn btn-outline-secondary btn-sm text-primary",attrs:{type:"button"},on:{click:i}},[n("i",{staticClass:"fa fa-calendar"})])])])]}}])}),t.description?n("small",{staticClass:"form-text text-muted w-100",domProps:{innerHTML:t._s(t.description)}}):t._e()],1)},s=[],i=n("60a3"),r=n("1315"),o=i["a"].extend({name:"DatePicker",model:{prop:"selectedDate",event:"change"},props:["label","selectedDate","minDate","clearButton","description"],data:function(){return{id:null,attrs:[]}},mounted:function(){this.id=this._uid},filters:{date:function(t){return t?r["DateTime"].fromISO(t).setLocale("de").toLocaleString(r["DateTime"].DATE_MED_WITH_WEEKDAY):""}},methods:{selectDate:function(t){var e=r["DateTime"].fromJSDate(t).toFormat("y-MM-dd");this.$emit("change",e)},clearDate:function(t){t.stopImmediatePropagation(),t.preventDefault(),this.$emit("change",null)}}}),c=o,l=n("2877"),d=Object(l["a"])(c,a,s,!1,null,null,null);e["a"]=d.exports}}]);
//# sourceMappingURL=news.4a2935e5.js.map